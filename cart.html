<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Giỏ Hàng</title>
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/header.css">
  <link rel="stylesheet" href="css/footer.css">
  <link rel="stylesheet" href="css/cart-page.css">
  <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
  <div class="topbar">
    <div class="inner">Hotline Mua Hàng: 0973 285 886 | Hotline CSKH: 1900 886 803 - Ext 1 | Email CSKH: 360boutique.vn@gmail.com</div>
  </div>
  <header class="site-header">
    <div class="header-inner">
      <a class="site-logo" href="index.html">
        <img src="images/logo.png" alt="360 Boutique" />
      </a>
      <div class="search-wrap">
        <input class="search-input" type="search" placeholder="Tìm kiếm sản phẩm ..." aria-label="Tìm kiếm" />
        <button class="search-btn" aria-label="Tìm kiếm">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21 21l-4.35-4.35" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><circle cx="11" cy="11" r="6" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>
      </div>
      <div class="site-icons">
        <a class="icon-btn" href="account.html" title="Tài khoản" aria-label="Tài khoản">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="#111" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><circle cx="12" cy="7" r="4" stroke="#111" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </a>
        <button class="icon-btn" title="Tìm" aria-label="Tìm">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21 21l-4.35-4.35" stroke="#111" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><circle cx="11" cy="11" r="6" stroke="#111" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>
        <a class="icon-btn" href="cart.html" title="Giỏ hàng" aria-label="Giỏ hàng">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 6h15l-1.5 9h-12z" stroke="#111" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><circle cx="9" cy="20" r="1" fill="#111"/><circle cx="19" cy="20" r="1" fill="#111"/></svg>
          <span class="cart-count" style="display:none;">0</span>
        </a>
      </div>
    </div>
    <nav class="main-nav">
      <div class="nav-inner">
        <a href="index.html">Giới thiệu</a>
        <a href="product.html">Sản phẩm</a>
          <a href="promotions.html">Khuyến mãi</a>
        <a href="news.html">Tin tức</a>
        <a href="#">Tuyển dụng</a>
        <a href="store-locator.html">Hệ thống cửa hàng</a>
      </div>
    </nav>
  </header>

  <main class="cart-page">
    <div class="container">
      <h1>Giỏ Hàng Của Bạn</h1>
      
      <div class="cart-content">
        <div class="cart-items-section">
          <div id="cart-items" class="cart-list">
            <!-- Items rendered here -->
          </div>
        </div>

        <div class="cart-summary">
          <div class="summary-box">
            <h3>Tổng Cộng</h3>
            <div class="summary-row">
              <span>Subtotal:</span>
              <span id="cart-total">0đ</span>
            </div>
            <div class="summary-row">
              <span>Shipping:</span>
              <span>Miễn phí</span>
            </div>
            <div class="summary-row total-row">
              <span>Total:</span>
              <span id="cart-grand-total">0đ</span>
            </div>
            <button id="checkout-btn" class="btn-checkout">Thanh toán</button>
            <a href="promotions.html" class="btn-continue">← Tiếp tục mua sắm</a>
          </div>
        </div>
      </div>
    </div>
  </main>

  <div class="payment-modal" id="payment-modal" aria-hidden="true">
    <div class="payment-dialog" role="dialog" aria-modal="true" aria-labelledby="payment-title">
      <button class="payment-close" type="button" aria-label="Đóng">×</button>
      <h3 id="payment-title">Thanh toán chuyển khoản</h3>
      <div class="payment-qr">
        <img src="images/qr.jpg" alt="QR chuyển khoản" />
      </div>
      <div class="payment-info">
        <div><strong>Ngân hàng:</strong> Mb Bank</div>
        <div><strong>Chủ tài khoản:</strong> DANG QUANG DIEN</div>
        <div><strong>Số tài khoản:</strong> 9966228386</div>
        <div class="payment-amount"><strong>Số tiền:</strong> <span id="payment-amount">0đ</span></div>
        <div class="payment-note"><strong>Nội dung chuyển khoản:</strong> <span id="payment-note">N3-000000</span></div>
        <div class="payment-note">Hệ thống sẽ tự động trở về trang chủ khi bạn thanh toán online thành công!</div>
      </div>
    </div>
  </div>

  <footer>
    <div class="footer-top">
      <div class="footer-grid">
        <div class="footer-col">
          <h4 class="title">HỆ THỐNG CỬA HÀNG</h4>
          <ul>
            <li>27 Chùa Bộc, Vinh ,Việt Nam</li>
            <li>242 Thái Hà, Đống Đa, HN</li>
            <li>63 Đại Cổ Việt, Hai Bà Trưng, HN</li>
            <li>20 Dương Quảng Hàm, Cầu Giấy, HN</li>
            <li>346 Cầu Giấy, Cầu Giấy, HN</li>
            <li>116 Hồ Tùng Mậu, Cầu Giấy, HN</li>
            <li>29 Phố Nhổn, Nam Từ Liêm, HN</li>
            <li>296 Nguyễn Trãi, Hà Đông, HN</li>
            <li>24 Trần Phú, Hà Đông, HN</li>
            <li>69 Quang Trung, Hà Đông, HN</li>
            <li>272 Tô Hiệu, Lê Chân, HP</li>
          </ul>
        </div>

        <div class="footer-col address">
          <h4 class="title">ĐỊA CHỈ</h4>
          <p><strong>CÔNG TY CỔ PHẦN THỜI TRANG 360</strong></p>
          <p>VPGD: Đội 6, Xã Phương Đình, Huyện Đan Phượng, Thành phố Vinh, Việt nam</p>
          <p>Facebook thời trang nam: 360Boutique</p>
          <p>Hotline: 0973285886 – 0862052988</p>
          <p>Email: 360boutique.vn@gmail.com</p>
          <p>Website: https://360boutique.vn/</p>
          <p>GPKD: 0107756568</p>
        </div>

        <div class="footer-col fanpage">
          <h4 class="title">Fanpage</h4>
          <img src="images/nhom_3_mon_web.png" alt="fanpage" />
        </div>
      </div>
    </div>

    <div class="footer-bottom">
      <div class="inner">
        <div>©opyright by 11-2025 Team number 3</div>
          <div>Địa chỉ: Số 44, Đường Phượng Hoàng, Thành phố Vinh</div>
      </div>
    </div>
  </footer>

  <script src="js/cart.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function(){
      // sync grand total
      const updateGrandTotal = ()=>{
        const total = cart.total();
        const gt = document.getElementById('cart-grand-total');
        if(gt) gt.textContent = formatVnd(total);
      };
      
      function formatVnd(num){ 
        const n = parseInt(num||0,10); 
        if(isNaN(n)) return num; 
        return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, '.') + 'đ'; 
      }

      // render cart and sync totals
      cart.renderCart();
      updateGrandTotal();

      // re-render when items change (intercept renderCart)
      const origRender = cart.renderCart;
      cart.renderCart = function(){
        origRender();
        updateGrandTotal();
      };

      // checkout handler
      const checkoutBtn = document.getElementById('checkout-btn');
      const paymentModal = document.getElementById('payment-modal');
      const paymentAmount = document.getElementById('payment-amount');
      const paymentNote = document.getElementById('payment-note');
      const paymentClose = document.querySelector('.payment-close');

      const openModal = (total) => {
        const orderCode = 'N3-' + Math.floor(Math.random() * 100000).toString().padStart(6, '0');
        if(paymentAmount) paymentAmount.textContent = formatVnd(total);
        if(paymentNote) paymentNote.textContent = orderCode;
        if(paymentModal){
          paymentModal.classList.add('show');
          paymentModal.setAttribute('aria-hidden', 'false');
        }
      };

      const closeModal = () => {
        if(paymentModal){
          paymentModal.classList.remove('show');
          paymentModal.setAttribute('aria-hidden', 'true');
        }
      };
      if(checkoutBtn){
        checkoutBtn.addEventListener('click', ()=>{
          const total = cart.total();
          if(total <= 0){
            alert('Giỏ hàng trống. Vui lòng thêm sản phẩm.');
            return;
          }
          openModal(total);
        });
      }

      if(paymentClose){
        paymentClose.addEventListener('click', closeModal);
      }
      if(paymentModal){
        paymentModal.addEventListener('click', (e)=>{
          if(e.target === paymentModal) closeModal();
        });
      }
      document.addEventListener('keydown', (e)=>{
        if(e.key === 'Escape') closeModal();
      });
    });
  </script>
</body>
</html>
